# üîß –û–¢–ß–Å–¢: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –û–®–ò–ë–û–ö

**–î–∞—Ç–∞:** 17 –æ–∫—Ç—è–±—Ä—è 2025  
**–í—Ä–µ–º—è:** 21:45  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –û–®–ò–ë–ö–ò –ò–°–ü–†–ê–í–õ–ï–ù–´!

---

## üêõ –ù–ê–ô–î–ï–ù–ù–´–ï –û–®–ò–ë–ö–ò

### **–û—à–∏–±–∫–∞ 1: `params.id` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å awaited**

**–°–∏–º–ø—Ç–æ–º:**

```
Error: Route "/api/supplier-categories/[id]" used `params.id`.
`params` should be awaited before using its properties.
```

**–ü—Ä–∏—á–∏–Ω–∞:**

- Next.js 15 —Ç—Ä–µ–±—É–µ—Ç `await` –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–∞—Ä—à—Ä—É—Ç–∞
- –°—Ç–∞—Ä—ã–π –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ `params.id`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```typescript
// –î–û
export async function DELETE(
	request: NextRequest,
	{ params }: { params: { id: string } }
) {
	const id = params.id
}

// –ü–û–°–õ–ï
export async function DELETE(
	request: NextRequest,
	{ params }: { params: Promise<{ id: string }> }
) {
	const { id } = await params
}
```

---

### **–û—à–∏–±–∫–∞ 2: Foreign Key Constraint**

**–°–∏–º–ø—Ç–æ–º:**

```
Foreign key constraint violated on the constraint:
`ProposalPosition_supplierCategoryId_fkey`
```

**–ü—Ä–∏—á–∏–Ω–∞:**

- –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å —Å–≤—è–∑—å –ø–æ—Å—Ç–∞–≤—â–∏–∫-–∫–∞—Ç–µ–≥–æ—Ä–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–∏—Ä—É–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑-–∑–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –∫–ª—é—á–∞

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```typescript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ —Å–≤—è–∑—å –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö
const usedInProposals = await prisma.proposalPosition.findFirst({
	where: { supplierCategoryId: id },
})

if (usedInProposals) {
	return NextResponse.json(
		{
			error:
				'–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Å–≤—è–∑—å: –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö. –°–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç–µ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏.',
		},
		{ status: 400 }
	)
}
```

---

### **–û—à–∏–±–∫–∞ 3: `null` –≤ input –ø–æ–ª—è—Ö**

**–°–∏–º–ø—Ç–æ–º:**

```
`value` prop on `input` should not be null.
Consider using an empty string to clear the component.
```

**–ü—Ä–∏—á–∏–Ω–∞:**

- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –∏–∑ –ë–î, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—è –∏–º–µ—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ `null`
- React —Ç—Ä–µ–±—É–µ—Ç –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É `''` –≤–º–µ—Å—Ç–æ `null` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã—Ö input

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```typescript
// –î–û
setFormData(prev => ({ ...prev, ...initialData }))

// –ü–û–°–õ–ï
const sanitizedData = {
	...initialData,
	email: initialData.email ?? '',
	contactPerson: initialData.contactPerson ?? '',
	address: initialData.address ?? '',
	codiceFiscale: initialData.codiceFiscale ?? '',
	partitaIVA: initialData.partitaIVA ?? '',
	legalAddress: initialData.legalAddress ?? '',
	paymentTerms: initialData.paymentTerms ?? '',
	deliveryDays: initialData.deliveryDays?.toString() ?? '',
	minOrderAmount: initialData.minOrderAmount?.toString() ?? '',
	rating: initialData.rating?.toString() ?? '5',
	notes: initialData.notes ?? '',
}
setFormData(prev => ({ ...prev, ...sanitizedData }))
```

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### **1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω API endpoint —É–¥–∞–ª–µ–Ω–∏—è**

**–§–∞–π–ª:** `/src/app/api/supplier-categories/[id]/route.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `await` –¥–ª—è `params`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

**–ö–æ–¥:**

```typescript
export async function DELETE(
	request: NextRequest,
	{ params }: { params: Promise<{ id: string }> }
) {
	try {
		const { id } = await params

		// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
		const existingSupplierCategory =
			await prisma.supplierProductCategory.findUnique({
				where: { id },
			})

		if (!existingSupplierCategory) {
			return NextResponse.json({ error: 'Not found' }, { status: 404 })
		}

		// –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
		const usedInProposals = await prisma.proposalPosition.findFirst({
			where: { supplierCategoryId: id },
		})

		if (usedInProposals) {
			return NextResponse.json(
				{ error: '–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Å–≤—è–∑—å: –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö.' },
				{ status: 400 }
			)
		}

		// –£–¥–∞–ª—è–µ–º
		await prisma.supplierProductCategory.delete({ where: { id } })

		return NextResponse.json({ success: true })
	} catch (error) {
		return NextResponse.json({ error: 'Failed to delete' }, { status: 500 })
	}
}
```

---

### **2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ UI**

**–§–∞–π–ª:** `/src/components/supplier-categories-manager.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç—Å—è –¥–∞–ª—å–Ω–µ–π—à–µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ

**–ö–æ–¥:**

```typescript
if (response.ok) {
	setSupplierCategories(prev => prev.filter(sc => sc.categoryId !== categoryId))
} else {
	const errorData = await response.json()
	alert(errorData.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏')
	return
}
```

---

### **3. –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã**

**–§–∞–π–ª:** `/src/components/supplier-form-modal.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

- ‚úÖ –í—Å–µ `null` –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
- ‚úÖ –ß–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ —Å—Ç—Ä–æ–∫–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:**

- `null` ‚Üí `''`
- `number | null` ‚Üí `string` (—Å `toString()`)
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π `rating` ‚Üí `'5'`

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### **–¢–µ—Å—Ç 1: –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏**

```
1. –û—Ç–∫—Ä—ã—Ç—å –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ ‚Üí –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
2. –í—ã–±—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö
3. –ö–ª–∏–∫–Ω—É—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ, —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å
‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è —É–¥–∞–ª—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏
```

### **–¢–µ—Å—Ç 2: –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é**

```
1. –û—Ç–∫—Ä—ã—Ç—å –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ ‚Üí –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
2. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è —É–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é, –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö
‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è –æ—Å—Ç–∞–µ—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π
```

### **–¢–µ—Å—Ç 3: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –±–µ–∑ –æ—à–∏–±–æ–∫**

```
1. –û—Ç–∫—Ä—ã—Ç—å –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ ‚Üí –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ª—é–±–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã
‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –æ null –≤ input
‚úÖ –í—Å–µ –ø–æ–ª—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å
```

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**

- ‚ùå –û—à–∏–±–∫–∞ `params.id should be awaited`
- ‚ùå –û—à–∏–±–∫–∞ `Foreign key constraint violated`
- ‚ùå –û—à–∏–±–∫–∞ `value prop should not be null`
- ‚ùå –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ
- ‚ùå –§–æ—Ä–º–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –æ—à–∏–±–∫–∏

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**

- ‚úÖ API —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç Next.js 15
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –í—Å–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏

---

## üéØ –£–õ–£–ß–®–ï–ù–ò–Ø

### **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**

- üîí –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
- üîí –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
- üîí –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### **UX:**

- üé® –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- üé® –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–Ω–∞–µ—Ç, –ø–æ—á–µ–º—É –Ω–µ –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å
- üé® –ù–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### **–ö–æ–¥:**

- üíª –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Next.js 15
- üíª –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- üíª –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö edge cases

---

## üìã –ò–ó–ú–ï–ù–ï–ù–ù–´–ï –§–ê–ô–õ–´

```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îî‚îÄ‚îÄ api/
‚îÇ       ‚îî‚îÄ‚îÄ supplier-categories/
‚îÇ           ‚îî‚îÄ‚îÄ [id]/
‚îÇ               ‚îî‚îÄ‚îÄ route.ts                   ‚Üê –ò–°–ü–†–ê–í–õ–ï–ù ‚úÖ
‚îÇ
‚îî‚îÄ‚îÄ components/
    ‚îú‚îÄ‚îÄ supplier-categories-manager.tsx        ‚Üê –ò–°–ü–†–ê–í–õ–ï–ù ‚úÖ
    ‚îî‚îÄ‚îÄ supplier-form-modal.tsx                ‚Üê –ò–°–ü–†–ê–í–õ–ï–ù ‚úÖ
```

---

## üöÄ –°–¢–ê–¢–£–°

**–í–°–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò –ò–°–ü–†–ê–í–õ–ï–ù–´!**

–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫:

- ‚úÖ Next.js 15 —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ë–î
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ UI

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ
